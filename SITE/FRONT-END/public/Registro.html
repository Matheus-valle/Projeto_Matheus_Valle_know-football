<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/cadastro.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lilita+One&display=swap" rel="stylesheet">
    <title>Registro</title>
</head>
<body>
    <header>
        <img src="./assets/LOGO.png" alt="img" class="logo">
        <div class="header_textos">
            <ul>
                <li><a href="index.html">HOME</a></li>
                <li><a href="Regras.html">REGRAS</a></li>
                <li><a href="Papéis.html">PAPÉIS</a></li>
                <li><a href="Formações.html">FORMAÇÕES</a></li>
                <li><a href="Equipamentos.html">EQUIPAMENTOS</a></li>
            </ul>
            <div class="botão_login_registro">
               <a  style="color: white; font-size: 20px; align-items: center;" href="./Login.html">LOGIN</a>
            </div>
            <div class="botão_login_registro">
               <a  style="color: white; font-size: 20px; align-items: center;" href="./Registro.html">REGISTRO</a>
            </div>
        </div>
    </header>
    <section class="login_cadastro">
        <h1>REGISTRO</h1>
        <br>
        <p>Nome</p>
        <input id="input_nome"  type="text"><br>
        <p>Data de Nascimento</p>
        <input  id="input_data"  type="date"><br>
         <p>Email</p>
        <input id="input_email"  type="text"><br>
         <p>Senha</p>
        <input id="input_senha"  type="password"><br>
         <p>Confirmar Senha</p>
        <input id="input_confirmarSenha"  type="password"><br>
        <div class="erros">
                    <button class="botao_cadastro_login" onclick="enviar_registro()">REGISTRO</button><br>
        <div id="div_erro"></div>

        </div>


    </section>
    <footer>
        <div>    
            <ul>
                <li>HOME</li>
                <li>REGRAS</li>
                <li>PAPÉIS</li>
                <li>FORMAÇÕES</li>
                <li>EQUIPAMENTOS</li>
            </ul>
        </div>
        <h1>Know Footbal @ 2025</h1>
    </footer>
</body>
</html>
<script>
    function enviar_registro() {
        var nome = input_nome.value
        var data = input_data.value
        var email = input_email.value
        var senha = input_senha.value
        var confirmar_senhha = input_confirmarSenha.value
        var mensagem = ""
        var contador_validações = 0
        var temMaiuscula = 0
        var temMinuscula = 0
        var temnumero = 0
        if (nome == "" || email == "" || senha == "" || confirmar_senhha == "") {
            mensagem += 'Não podem conter campos vazios! <br>'
            contador_validações++
        }

        

        if (senha != confirmar_senhha) {
            mensagem += 'senha não conrresponde ao confirmar senha'
            contador_validações++
        } 
        console.log(data)
        if (data  >= '2009') {
            mensagem += 'Data de nascimento não inserida corretamente ou usuario menor de 16 anos <br>'
            contador_validações++
        }

        if (email.includes('@') == false) {
            mensagem += 'Endereço de email invalido <br>'
            contador_validações++
        } 

   

        for(i = 0; i <= senha.length; i++) {
            var senha_momento = senha[i]

            if (senha_momento >= "A" &&  senha_momento <= "Z") {
                temMaiuscula = 1
            }
            if (senha_momento >= "a" && senha_momento <= "z") {
                temMinuscula = 1
            } 
            if (senha_momento >= "0" && senha_momento <= "9") {
                temnumero = 1
            }
        }

        if(temMaiuscula == 0) {
            mensagem += 'Senha não possui  letra maiscula <br>'
            contador_validações++
        } 

        if(temMinuscula == 0) {
            mensagem += 'Senha não possui letra minuscula <br>'
            contador_validações++
        } 

        if(temnumero == 0) {
            mensagem += 'Senha não possui numero <br>'
             contador_validações++ 
        } 
           

        
        div_erro.innerHTML = `<b>${mensagem}</b>`
        console.log(contador_validações)
        if (contador_validações == 0) {

            fetch("/usuarios/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/usuario.js
        nomeServer: nome,
        emailServer: email,
        senhaServer:  senha,
      }),
    })
      .then(function (resposta) {
        console.log("resposta: ", resposta);
            resposta.json().then(json => {
                sessionStorage.NOME_USUARIO = json.nome
                sessionStorage.EMAIL_USUARIO = json.email
            })

        if (resposta.ok) {
    
          setTimeout(() => {
            window.location = "./dashboard/continuação_cadastro.html";
          }, "2000");

        
          
        } else {
          throw "Houve um erro ao tentar realizar o cadastro!";
        }
      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
       
      });

    return false;
  }

  // Listando empresas cadastradas 
  


}
    
    
</script>


